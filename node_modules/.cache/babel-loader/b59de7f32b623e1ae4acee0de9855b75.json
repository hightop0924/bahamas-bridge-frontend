{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_Subscription,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscription } from '../Subscription';\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function bufferWhen(closingSelector) {\n  return function (source) {\n    return source.lift(new BufferWhenOperator(closingSelector));\n  };\n}\nvar BufferWhenOperator = /*@__PURE__*/function () {\n  function BufferWhenOperator(closingSelector) {\n    this.closingSelector = closingSelector;\n  }\n  BufferWhenOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new BufferWhenSubscriber(subscriber, this.closingSelector));\n  };\n  return BufferWhenOperator;\n}();\nvar BufferWhenSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(BufferWhenSubscriber, _super);\n  function BufferWhenSubscriber(destination, closingSelector) {\n    var _this = _super.call(this, destination) || this;\n    _this.closingSelector = closingSelector;\n    _this.subscribing = false;\n    _this.openBuffer();\n    return _this;\n  }\n  BufferWhenSubscriber.prototype._next = function (value) {\n    this.buffer.push(value);\n  };\n  BufferWhenSubscriber.prototype._complete = function () {\n    var buffer = this.buffer;\n    if (buffer) {\n      this.destination.next(buffer);\n    }\n    _super.prototype._complete.call(this);\n  };\n  BufferWhenSubscriber.prototype._unsubscribe = function () {\n    this.buffer = undefined;\n    this.subscribing = false;\n  };\n  BufferWhenSubscriber.prototype.notifyNext = function () {\n    this.openBuffer();\n  };\n  BufferWhenSubscriber.prototype.notifyComplete = function () {\n    if (this.subscribing) {\n      this.complete();\n    } else {\n      this.openBuffer();\n    }\n  };\n  BufferWhenSubscriber.prototype.openBuffer = function () {\n    var closingSubscription = this.closingSubscription;\n    if (closingSubscription) {\n      this.remove(closingSubscription);\n      closingSubscription.unsubscribe();\n    }\n    var buffer = this.buffer;\n    if (this.buffer) {\n      this.destination.next(buffer);\n    }\n    this.buffer = [];\n    var closingNotifier;\n    try {\n      var closingSelector = this.closingSelector;\n      closingNotifier = closingSelector();\n    } catch (err) {\n      return this.error(err);\n    }\n    closingSubscription = new Subscription();\n    this.closingSubscription = closingSubscription;\n    this.add(closingSubscription);\n    this.subscribing = true;\n    closingSubscription.add(innerSubscribe(closingNotifier, new SimpleInnerSubscriber(this)));\n    this.subscribing = false;\n  };\n  return BufferWhenSubscriber;\n}(SimpleOuterSubscriber);","map":{"version":3,"sources":["../../../src/internal/operators/bufferWhen.ts"],"names":[],"mappings":"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","sourcesContent":["/** PURE_IMPORTS_START tslib,_Subscription,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscription } from '../Subscription';\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function bufferWhen(closingSelector) {\n    return function (source) {\n        return source.lift(new BufferWhenOperator(closingSelector));\n    };\n}\nvar BufferWhenOperator = /*@__PURE__*/ (function () {\n    function BufferWhenOperator(closingSelector) {\n        this.closingSelector = closingSelector;\n    }\n    BufferWhenOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new BufferWhenSubscriber(subscriber, this.closingSelector));\n    };\n    return BufferWhenOperator;\n}());\nvar BufferWhenSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(BufferWhenSubscriber, _super);\n    function BufferWhenSubscriber(destination, closingSelector) {\n        var _this = _super.call(this, destination) || this;\n        _this.closingSelector = closingSelector;\n        _this.subscribing = false;\n        _this.openBuffer();\n        return _this;\n    }\n    BufferWhenSubscriber.prototype._next = function (value) {\n        this.buffer.push(value);\n    };\n    BufferWhenSubscriber.prototype._complete = function () {\n        var buffer = this.buffer;\n        if (buffer) {\n            this.destination.next(buffer);\n        }\n        _super.prototype._complete.call(this);\n    };\n    BufferWhenSubscriber.prototype._unsubscribe = function () {\n        this.buffer = undefined;\n        this.subscribing = false;\n    };\n    BufferWhenSubscriber.prototype.notifyNext = function () {\n        this.openBuffer();\n    };\n    BufferWhenSubscriber.prototype.notifyComplete = function () {\n        if (this.subscribing) {\n            this.complete();\n        }\n        else {\n            this.openBuffer();\n        }\n    };\n    BufferWhenSubscriber.prototype.openBuffer = function () {\n        var closingSubscription = this.closingSubscription;\n        if (closingSubscription) {\n            this.remove(closingSubscription);\n            closingSubscription.unsubscribe();\n        }\n        var buffer = this.buffer;\n        if (this.buffer) {\n            this.destination.next(buffer);\n        }\n        this.buffer = [];\n        var closingNotifier;\n        try {\n            var closingSelector = this.closingSelector;\n            closingNotifier = closingSelector();\n        }\n        catch (err) {\n            return this.error(err);\n        }\n        closingSubscription = new Subscription();\n        this.closingSubscription = closingSubscription;\n        this.add(closingSubscription);\n        this.subscribing = true;\n        closingSubscription.add(innerSubscribe(closingNotifier, new SimpleInnerSubscriber(this)));\n        this.subscribing = false;\n    };\n    return BufferWhenSubscriber;\n}(SimpleOuterSubscriber));\n//# sourceMappingURL=bufferWhen.js.map\n"]},"metadata":{},"sourceType":"module"}