{"ast":null,"code":"var _s = $RefreshSig$();\nimport { fetchConfirmations } from 'lib/amb';\nimport { getNetworkLabel, logError } from 'lib/helpers';\nimport { getEthersProvider } from 'lib/providers';\nimport { useEffect, useState } from 'react';\nexport const useTotalConfirms = (homeChainId, foreignChainId, homeAmbAddress, foreignAmbAddress) => {\n  _s();\n  const [homeTotalConfirms, setHomeTotalConfirms] = useState(8);\n  const [foreignTotalConfirms, setForeignTotalConfirms] = useState(8);\n  useEffect(() => {\n    const homeLabel = getNetworkLabel(homeChainId).toUpperCase();\n    const homeKey = `${homeLabel}-${homeAmbAddress.toUpperCase()}-TOTAL-CONFIRMATIONS`;\n    const foreignLabel = getNetworkLabel(foreignChainId).toUpperCase();\n    const foreignKey = `${foreignLabel}-${foreignAmbAddress.toUpperCase()}-TOTAL-CONFIRMATIONS`;\n    const fetchConfirms = async () => {\n      try {\n        const [homeProvider, foreignProvider] = await Promise.all([getEthersProvider(homeChainId), getEthersProvider(foreignChainId)]);\n        const [home, foreign] = await Promise.all([fetchConfirmations(homeAmbAddress, homeProvider), fetchConfirmations(foreignAmbAddress, foreignProvider)]);\n        setHomeTotalConfirms(home);\n        setForeignTotalConfirms(foreign);\n        sessionStorage.setItem(homeKey, home);\n        sessionStorage.setItem(foreignKey, foreign);\n      } catch (confirmsError) {\n        logError({\n          confirmsError\n        });\n      }\n    };\n    const homeConfirms = sessionStorage.getItem(homeKey);\n    const foreignConfirms = sessionStorage.getItem(foreignKey);\n    if (homeConfirms && foreignConfirms) {\n      setHomeTotalConfirms(Number.parseInt(homeConfirms, 10));\n      setForeignTotalConfirms(Number.parseInt(foreignConfirms, 10));\n    } else {\n      fetchConfirms();\n    }\n  }, [homeChainId, foreignChainId, homeAmbAddress, foreignAmbAddress]);\n  return {\n    homeTotalConfirms,\n    foreignTotalConfirms\n  };\n};\n_s(useTotalConfirms, \"ztsvp26w14TRRpPvVvotyTDfF9I=\");","map":{"version":3,"names":["fetchConfirmations","getNetworkLabel","logError","getEthersProvider","useEffect","useState","useTotalConfirms","homeChainId","foreignChainId","homeAmbAddress","foreignAmbAddress","_s","homeTotalConfirms","setHomeTotalConfirms","foreignTotalConfirms","setForeignTotalConfirms","homeLabel","toUpperCase","homeKey","foreignLabel","foreignKey","fetchConfirms","homeProvider","foreignProvider","Promise","all","home","foreign","sessionStorage","setItem","confirmsError","homeConfirms","getItem","foreignConfirms","Number","parseInt"],"sources":["/home/hightop/bahamas_bridge/omnibridge-ui/packages/dapp/src/hooks/useTotalConfirms.js"],"sourcesContent":["import { fetchConfirmations } from 'lib/amb';\nimport { getNetworkLabel, logError } from 'lib/helpers';\nimport { getEthersProvider } from 'lib/providers';\nimport { useEffect, useState } from 'react';\n\nexport const useTotalConfirms = (\n  homeChainId,\n  foreignChainId,\n  homeAmbAddress,\n  foreignAmbAddress,\n) => {\n  const [homeTotalConfirms, setHomeTotalConfirms] = useState(8);\n  const [foreignTotalConfirms, setForeignTotalConfirms] = useState(8);\n\n  useEffect(() => {\n    const homeLabel = getNetworkLabel(homeChainId).toUpperCase();\n    const homeKey = `${homeLabel}-${homeAmbAddress.toUpperCase()}-TOTAL-CONFIRMATIONS`;\n\n    const foreignLabel = getNetworkLabel(foreignChainId).toUpperCase();\n    const foreignKey = `${foreignLabel}-${foreignAmbAddress.toUpperCase()}-TOTAL-CONFIRMATIONS`;\n\n    const fetchConfirms = async () => {\n      try {\n        const [homeProvider, foreignProvider] = await Promise.all([\n          getEthersProvider(homeChainId),\n          getEthersProvider(foreignChainId),\n        ]);\n        const [home, foreign] = await Promise.all([\n          fetchConfirmations(homeAmbAddress, homeProvider),\n          fetchConfirmations(foreignAmbAddress, foreignProvider),\n        ]);\n        setHomeTotalConfirms(home);\n        setForeignTotalConfirms(foreign);\n        sessionStorage.setItem(homeKey, home);\n        sessionStorage.setItem(foreignKey, foreign);\n      } catch (confirmsError) {\n        logError({ confirmsError });\n      }\n    };\n\n    const homeConfirms = sessionStorage.getItem(homeKey);\n    const foreignConfirms = sessionStorage.getItem(foreignKey);\n    if (homeConfirms && foreignConfirms) {\n      setHomeTotalConfirms(Number.parseInt(homeConfirms, 10));\n      setForeignTotalConfirms(Number.parseInt(foreignConfirms, 10));\n    } else {\n      fetchConfirms();\n    }\n  }, [homeChainId, foreignChainId, homeAmbAddress, foreignAmbAddress]);\n\n  return { homeTotalConfirms, foreignTotalConfirms };\n};\n"],"mappings":";AAAA,SAASA,kBAAkB,QAAQ,SAAS;AAC5C,SAASC,eAAe,EAAEC,QAAQ,QAAQ,aAAa;AACvD,SAASC,iBAAiB,QAAQ,eAAe;AACjD,SAASC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAE3C,OAAO,MAAMC,gBAAgB,GAAGA,CAC9BC,WAAW,EACXC,cAAc,EACdC,cAAc,EACdC,iBAAiB,KACd;EAAAC,EAAA;EACH,MAAM,CAACC,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGR,QAAQ,CAAC,CAAC,CAAC;EAC7D,MAAM,CAACS,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGV,QAAQ,CAAC,CAAC,CAAC;EAEnED,SAAS,CAAC,MAAM;IACd,MAAMY,SAAS,GAAGf,eAAe,CAACM,WAAW,CAAC,CAACU,WAAW,CAAC,CAAC;IAC5D,MAAMC,OAAO,GAAI,GAAEF,SAAU,IAAGP,cAAc,CAACQ,WAAW,CAAC,CAAE,sBAAqB;IAElF,MAAME,YAAY,GAAGlB,eAAe,CAACO,cAAc,CAAC,CAACS,WAAW,CAAC,CAAC;IAClE,MAAMG,UAAU,GAAI,GAAED,YAAa,IAAGT,iBAAiB,CAACO,WAAW,CAAC,CAAE,sBAAqB;IAE3F,MAAMI,aAAa,GAAG,MAAAA,CAAA,KAAY;MAChC,IAAI;QACF,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,CACxDtB,iBAAiB,CAACI,WAAW,CAAC,EAC9BJ,iBAAiB,CAACK,cAAc,CAAC,CAClC,CAAC;QACF,MAAM,CAACkB,IAAI,EAAEC,OAAO,CAAC,GAAG,MAAMH,OAAO,CAACC,GAAG,CAAC,CACxCzB,kBAAkB,CAACS,cAAc,EAAEa,YAAY,CAAC,EAChDtB,kBAAkB,CAACU,iBAAiB,EAAEa,eAAe,CAAC,CACvD,CAAC;QACFV,oBAAoB,CAACa,IAAI,CAAC;QAC1BX,uBAAuB,CAACY,OAAO,CAAC;QAChCC,cAAc,CAACC,OAAO,CAACX,OAAO,EAAEQ,IAAI,CAAC;QACrCE,cAAc,CAACC,OAAO,CAACT,UAAU,EAAEO,OAAO,CAAC;MAC7C,CAAC,CAAC,OAAOG,aAAa,EAAE;QACtB5B,QAAQ,CAAC;UAAE4B;QAAc,CAAC,CAAC;MAC7B;IACF,CAAC;IAED,MAAMC,YAAY,GAAGH,cAAc,CAACI,OAAO,CAACd,OAAO,CAAC;IACpD,MAAMe,eAAe,GAAGL,cAAc,CAACI,OAAO,CAACZ,UAAU,CAAC;IAC1D,IAAIW,YAAY,IAAIE,eAAe,EAAE;MACnCpB,oBAAoB,CAACqB,MAAM,CAACC,QAAQ,CAACJ,YAAY,EAAE,EAAE,CAAC,CAAC;MACvDhB,uBAAuB,CAACmB,MAAM,CAACC,QAAQ,CAACF,eAAe,EAAE,EAAE,CAAC,CAAC;IAC/D,CAAC,MAAM;MACLZ,aAAa,CAAC,CAAC;IACjB;EACF,CAAC,EAAE,CAACd,WAAW,EAAEC,cAAc,EAAEC,cAAc,EAAEC,iBAAiB,CAAC,CAAC;EAEpE,OAAO;IAAEE,iBAAiB;IAAEE;EAAqB,CAAC;AACpD,CAAC;AAACH,EAAA,CA9CWL,gBAAgB"},"metadata":{},"sourceType":"module"}