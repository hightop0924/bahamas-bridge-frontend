{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SafeAppWeb3Modal = void 0;\nconst safe_apps_sdk_1 = __importDefault(require(\"@gnosis.pm/safe-apps-sdk\"));\nconst safe_apps_provider_1 = require(\"@gnosis.pm/safe-apps-provider\");\nconst web3modal_1 = __importDefault(require(\"web3modal\"));\nclass SafeAppWeb3Modal extends web3modal_1.default {\n  constructor(options, sdk) {\n    super(options);\n    this.triedToConnect = false;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    this.requestProvider = async () => {\n      if (await this.isSafeApp()) {\n        return this.getProvider();\n      }\n      return this.connect();\n    };\n    this.sdk = sdk || new safe_apps_sdk_1.default();\n  }\n  async getConnectedSafe() {\n    if (!this.safe && !this.triedToConnect) {\n      this.safe = await Promise.race([this.sdk.safe.getInfo(), new Promise(resolve => setTimeout(resolve, 200))]);\n      this.triedToConnect = true;\n    }\n    return this.safe;\n  }\n  async getProvider() {\n    if (!this.provider) {\n      const safe = await this.getConnectedSafe();\n      if (!safe) throw Error('Could not load Safe information');\n      this.provider = new safe_apps_provider_1.SafeAppProvider(safe, this.sdk);\n    }\n    return this.provider;\n  }\n  async isSafeApp() {\n    // check if we're in an iframe\n    if ((window === null || window === void 0 ? void 0 : window.parent) === window) {\n      return false;\n    }\n    const safe = await this.getConnectedSafe();\n    return !!safe;\n  }\n}\nexports.SafeAppWeb3Modal = SafeAppWeb3Modal;","map":{"version":3,"sources":["../src/modal.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,MAAA,eAAA,GAAA,eAAA,CAAA,OAAA,CAAA,0BAAA,CAAA,CAAA;AACA,MAAA,oBAAA,GAAA,OAAA,CAAA,+BAAA,CAAA;AACA,MAAA,WAAA,GAAA,eAAA,CAAA,OAAA,CAAA,WAAA,CAAA,CAAA;AAEA,MAAa,gBAAiB,SAAQ,WAAA,CAAA,OAAS,CAAA;EAM7C,WAAA,CAAY,OAA+B,EAAE,GAAiB,EAAA;IAC5D,KAAK,CAAC,OAAO,CAAC;IAHR,IAAA,CAAA,cAAc,GAAG,KAAK;IA4B9B;IACO,IAAA,CAAA,eAAe,GAAG,YAAyB;MAChD,IAAI,MAAM,IAAI,CAAC,SAAS,CAAA,CAAE,EAAE;QAC1B,OAAO,IAAI,CAAC,WAAW,CAAA,CAAE;MAC1B;MACD,OAAO,IAAI,CAAC,OAAO,CAAA,CAAE;IACvB,CAAC;IA9BC,IAAI,CAAC,GAAG,GAAG,GAAG,IAAI,IAAI,eAAA,CAAA,OAAW,CAAA,CAAE;EACrC;EAEQ,MAAM,gBAAgB,CAAA,EAAA;IAC5B,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;MACtC,IAAI,CAAC,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,CAAC,CAC7B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAA,CAAE,EACvB,IAAI,OAAO,CAAa,OAAO,IAAK,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAC9D,CAAC;MACF,IAAI,CAAC,cAAc,GAAG,IAAI;IAC3B;IAED,OAAO,IAAI,CAAC,IAAI;EAClB;EAEA,MAAM,WAAW,CAAA,EAAA;IACf,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;MAClB,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAA,CAAE;MAC1C,IAAI,CAAC,IAAI,EAAE,MAAM,KAAK,CAAC,iCAAiC,CAAC;MACzD,IAAI,CAAC,QAAQ,GAAG,IAAI,oBAAA,CAAA,eAAe,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC;IACpD;IACD,OAAO,IAAI,CAAC,QAAQ;EACtB;EAUO,MAAM,SAAS,CAAA,EAAA;IACpB;IACA,IAAI,CAAA,MAAM,KAAA,IAAA,IAAN,MAAM,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAN,MAAM,CAAE,MAAM,MAAK,MAAM,EAAE;MAC7B,OAAO,KAAK;IACb;IAED,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAA,CAAE;IAE1C,OAAO,CAAC,CAAC,IAAI;EACf;AACD;AAlDD,OAAA,CAAA,gBAAA,GAAA,gBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SafeAppWeb3Modal = void 0;\nconst safe_apps_sdk_1 = __importDefault(require(\"@gnosis.pm/safe-apps-sdk\"));\nconst safe_apps_provider_1 = require(\"@gnosis.pm/safe-apps-provider\");\nconst web3modal_1 = __importDefault(require(\"web3modal\"));\nclass SafeAppWeb3Modal extends web3modal_1.default {\n    constructor(options, sdk) {\n        super(options);\n        this.triedToConnect = false;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        this.requestProvider = async () => {\n            if (await this.isSafeApp()) {\n                return this.getProvider();\n            }\n            return this.connect();\n        };\n        this.sdk = sdk || new safe_apps_sdk_1.default();\n    }\n    async getConnectedSafe() {\n        if (!this.safe && !this.triedToConnect) {\n            this.safe = await Promise.race([\n                this.sdk.safe.getInfo(),\n                new Promise((resolve) => setTimeout(resolve, 200)),\n            ]);\n            this.triedToConnect = true;\n        }\n        return this.safe;\n    }\n    async getProvider() {\n        if (!this.provider) {\n            const safe = await this.getConnectedSafe();\n            if (!safe)\n                throw Error('Could not load Safe information');\n            this.provider = new safe_apps_provider_1.SafeAppProvider(safe, this.sdk);\n        }\n        return this.provider;\n    }\n    async isSafeApp() {\n        // check if we're in an iframe\n        if ((window === null || window === void 0 ? void 0 : window.parent) === window) {\n            return false;\n        }\n        const safe = await this.getConnectedSafe();\n        return !!safe;\n    }\n}\nexports.SafeAppWeb3Modal = SafeAppWeb3Modal;\n//# sourceMappingURL=modal.js.map"]},"metadata":{},"sourceType":"script"}