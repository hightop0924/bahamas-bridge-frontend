{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function audit(durationSelector) {\n  return function auditOperatorFunction(source) {\n    return source.lift(new AuditOperator(durationSelector));\n  };\n}\nvar AuditOperator = /*@__PURE__*/function () {\n  function AuditOperator(durationSelector) {\n    this.durationSelector = durationSelector;\n  }\n  AuditOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new AuditSubscriber(subscriber, this.durationSelector));\n  };\n  return AuditOperator;\n}();\nvar AuditSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(AuditSubscriber, _super);\n  function AuditSubscriber(destination, durationSelector) {\n    var _this = _super.call(this, destination) || this;\n    _this.durationSelector = durationSelector;\n    _this.hasValue = false;\n    return _this;\n  }\n  AuditSubscriber.prototype._next = function (value) {\n    this.value = value;\n    this.hasValue = true;\n    if (!this.throttled) {\n      var duration = void 0;\n      try {\n        var durationSelector = this.durationSelector;\n        duration = durationSelector(value);\n      } catch (err) {\n        return this.destination.error(err);\n      }\n      var innerSubscription = innerSubscribe(duration, new SimpleInnerSubscriber(this));\n      if (!innerSubscription || innerSubscription.closed) {\n        this.clearThrottle();\n      } else {\n        this.add(this.throttled = innerSubscription);\n      }\n    }\n  };\n  AuditSubscriber.prototype.clearThrottle = function () {\n    var _a = this,\n      value = _a.value,\n      hasValue = _a.hasValue,\n      throttled = _a.throttled;\n    if (throttled) {\n      this.remove(throttled);\n      this.throttled = undefined;\n      throttled.unsubscribe();\n    }\n    if (hasValue) {\n      this.value = undefined;\n      this.hasValue = false;\n      this.destination.next(value);\n    }\n  };\n  AuditSubscriber.prototype.notifyNext = function () {\n    this.clearThrottle();\n  };\n  AuditSubscriber.prototype.notifyComplete = function () {\n    this.clearThrottle();\n  };\n  return AuditSubscriber;\n}(SimpleOuterSubscriber);","map":{"version":3,"sources":["../../../src/internal/operators/audit.ts"],"names":[],"mappings":";AAKA,OAAO,KAAE,OAAA,MAAA,OAAuB;AAgDhC,SAAM,qBAAmB,EAAA,cAA0D,EAAA,qBAAA,QAAA,mBAAA;AACjF,OAAA,SAAO,KAAS,CAAA,gBAAA,EAAA;EACd,OAAA,SAAO,qBAAgB,CAAA,MAAc,EAAA;IACrC,OAAA,MAAA,CAAA,IAAA,CAAA,IAAA,aAAA,CAAA,gBAAA,CAAA,CAAA;EACH,CAAA;AAED;IACE,aAAA,GAAA,aAAoB,YAA0D;EAA1D,SAAA,aAAA,CAAA,gBAAA,EAAA;IACnB,IAAA,CAAA,gBAAA,GAAA,gBAAA;EAED;EACE,aAAO,CAAA,SAAO,CAAA,IAAU,GAAA,UAAI,UAAsB,EAAA,MAAU,EAAE;IAC/D,OAAA,MAAA,CAAA,SAAA,CAAA,IAAA,eAAA,CAAA,UAAA,EAAA,IAAA,CAAA,gBAAA,CAAA,CAAA;EACH,CAAA;EAAC,OAAA,aAAA;AAOD,CAAA,CAAA,CAAA;IAAoC,eAAA,GAAA,aAAA,UAA2B,MAAA,EAAA;EAM7D,OAAA,CAAA,SAAA,CAAA,eAAY,EAAA,MACQ,CAAA;EADpB,SAAA,eAEE,CAAA,WAAM,EAAA,gBAAY,EACnB;IAFmB,IAAA,KAAA,GAAA,MAAA,CAAA,IAAgB,CAAhB,IAAA,EAAA,WAAgB,CAA0C,IAAA,IAAA;IAJtE,KAAA,CAAA,gBAAyB,GAAC,gBAAA;;IAMjC,OAAA,KAAA;EAED;EACE,eAAU,CAAA,SAAS,CAAA,KAAA,GAAA,UAAA,KAAA,EAAA;IACnB,IAAI,CAAC,KAAA,GAAQ,KAAG;IAChB,IAAI,CAAC,QAAK,GAAA,IAAS;QACjB,CAAA,IAAI,CAAA,SAAQ,EAAA;MACZ,IAAI,QAAA,GAAA,KAAA,CAAA;UACM;QACR,IAAA,gBAAW,GAAA,IAAgB,CAAC,gBAAO;QACpC,QAAA,GAAA,gBAAA,CAAA,KAAA,CAAA;MAAC,CAAA,CACA,OAAA,GAAA,EAAO;QACR,OAAA,IAAA,CAAA,WAAA,CAAA,KAAA,CAAA,GAAA,CAAA;MACD;MACA,IAAI,iBAAC,GAAiB,cAAI,CAAA,QAAkB,EAAA,IAAQ,qBAAA,CAAA,IAAA,CAAA,CAAA;UAClD,CAAA,iBAAkB,IAAG,iBAAA,CAAA,MAAA,EAAA;QACtB,IAAA,CAAA,aAAA,CAAA,CAAA;OAAM,MACL;QACD,IAAA,CAAA,GAAA,CAAA,IAAA,CAAA,SAAA,GAAA,iBAAA,CAAA;MACF;IACF;EAED,CAAA;EACQ,eAAA,CAAA,SAAE,CAAA,aAAO,GAAA,YAAA;IACf,IAAI,EAAA,GAAA,IAAS;MAAE,KAAA,GAAA,EAAA,CAAA,KAAA;MAAA,QAAA,GAAA,EAAA,CAAA,QAAA;MAAA,SAAA,GAAA,EAAA,CAAA,SAAA;QACb,SAAK,EAAM;MACX,IAAI,CAAC,MAAA,CAAA,SAAY,CAAA;MACjB,IAAA,CAAA,SAAU,GAAA,SAAc;MACzB,SAAA,CAAA,WAAA,CAAA,CAAA;IACD;QACE,QAAK,EAAK;MACV,IAAI,CAAC,KAAA,GAAQ,SAAS;MACtB,IAAI,CAAC,QAAA,GAAW,KAAM;MACvB,IAAA,CAAA,WAAA,CAAA,IAAA,CAAA,KAAA,CAAA;IACF;EAED,CAAA;EACE,eAAK,CAAA,SAAgB,CAAA,UAAA,GAAA,YAAA;IACtB,IAAA,CAAA,aAAA,CAAA,CAAA;EAED,CAAA;EACE,eAAK,CAAA,SAAgB,CAAA,cAAA,GAAA,YAAA;IACtB,IAAA,CAAA,aAAA,CAAA,CAAA;EACH,CAAA;EApDoC,OAAA,eAoDnC","sourcesContent":["/** PURE_IMPORTS_START tslib,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function audit(durationSelector) {\n    return function auditOperatorFunction(source) {\n        return source.lift(new AuditOperator(durationSelector));\n    };\n}\nvar AuditOperator = /*@__PURE__*/ (function () {\n    function AuditOperator(durationSelector) {\n        this.durationSelector = durationSelector;\n    }\n    AuditOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new AuditSubscriber(subscriber, this.durationSelector));\n    };\n    return AuditOperator;\n}());\nvar AuditSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(AuditSubscriber, _super);\n    function AuditSubscriber(destination, durationSelector) {\n        var _this = _super.call(this, destination) || this;\n        _this.durationSelector = durationSelector;\n        _this.hasValue = false;\n        return _this;\n    }\n    AuditSubscriber.prototype._next = function (value) {\n        this.value = value;\n        this.hasValue = true;\n        if (!this.throttled) {\n            var duration = void 0;\n            try {\n                var durationSelector = this.durationSelector;\n                duration = durationSelector(value);\n            }\n            catch (err) {\n                return this.destination.error(err);\n            }\n            var innerSubscription = innerSubscribe(duration, new SimpleInnerSubscriber(this));\n            if (!innerSubscription || innerSubscription.closed) {\n                this.clearThrottle();\n            }\n            else {\n                this.add(this.throttled = innerSubscription);\n            }\n        }\n    };\n    AuditSubscriber.prototype.clearThrottle = function () {\n        var _a = this, value = _a.value, hasValue = _a.hasValue, throttled = _a.throttled;\n        if (throttled) {\n            this.remove(throttled);\n            this.throttled = undefined;\n            throttled.unsubscribe();\n        }\n        if (hasValue) {\n            this.value = undefined;\n            this.hasValue = false;\n            this.destination.next(value);\n        }\n    };\n    AuditSubscriber.prototype.notifyNext = function () {\n        this.clearThrottle();\n    };\n    AuditSubscriber.prototype.notifyComplete = function () {\n        this.clearThrottle();\n    };\n    return AuditSubscriber;\n}(SimpleOuterSubscriber));\n//# sourceMappingURL=audit.js.map\n"]},"metadata":{},"sourceType":"module"}