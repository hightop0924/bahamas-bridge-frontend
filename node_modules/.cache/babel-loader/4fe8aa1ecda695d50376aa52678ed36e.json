{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCachedUrl = exports.storeCachedURI = void 0;\n// 24 hour TTL\nconst DEFAULT_CACHE_TTL = 60 * 60 * 24 * 1000;\nconst getCache = () => {\n  const cache = window.localStorage.getItem('davatar/cache');\n  if (!cache) {\n    window.localStorage.setItem('davatar/cache', '{}');\n    return {};\n  }\n  return JSON.parse(cache);\n};\nconst saveCache = cache => window.localStorage.setItem('davatar/cache', JSON.stringify(cache));\nconst storeCachedURI = (address, resolvedUrl, ttl) => {\n  const cache = getCache();\n  const normalizedAddress = address.toLowerCase();\n  const item = cache[normalizedAddress];\n  if (!item || new Date(item.expiresAt) > new Date()) {\n    const expireDate = new Date(new Date().getTime() + (ttl || DEFAULT_CACHE_TTL));\n    cache[normalizedAddress] = {\n      url: resolvedUrl,\n      expiresAt: expireDate.toString()\n    };\n    saveCache(cache);\n  }\n};\nexports.storeCachedURI = storeCachedURI;\n/**\n * Get cached resolved url from local storage\n *\n * @param key - an ethereum address or an avatar URI\n */\nconst getCachedUrl = key => {\n  const cache = getCache();\n  const normalizedKey = key.toLowerCase();\n  const item = cache[normalizedKey];\n  if (item) {\n    if (new Date(item.expiresAt) > new Date()) {\n      return item.url;\n    }\n  }\n  return null;\n};\nexports.getCachedUrl = getCachedUrl;","map":{"version":3,"sources":["../src/cache.ts"],"names":[],"mappings":";;;;;;AAAA;AACA,MAAM,iBAAiB,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;AAM7C,MAAM,QAAQ,GAAG,CAAA,KAAmB;EAClC,MAAM,KAAK,GAAG,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,eAAe,CAAC;EAC1D,IAAI,CAAC,KAAK,EAAE;IACV,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,eAAe,EAAE,IAAI,CAAC;IAClD,OAAO,CAAA,CAAE;EACV;EAED,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;AAC1B,CAAC;AAED,MAAM,SAAS,GAAI,KAAmB,IAAK,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;AAEvG,MAAM,cAAc,GAAG,CAAC,OAAe,EAAE,WAAmB,EAAE,GAAY,KAAI;EACnF,MAAM,KAAK,GAAG,QAAQ,CAAA,CAAE;EACxB,MAAM,iBAAiB,GAAG,OAAO,CAAC,WAAW,CAAA,CAAE;EAC/C,MAAM,IAAI,GAAG,KAAK,CAAC,iBAAiB,CAAC;EAErC,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,IAAI,CAAA,CAAE,EAAE;IAClD,MAAM,UAAU,GAAG,IAAI,IAAI,CAAC,IAAI,IAAI,CAAA,CAAE,CAAC,OAAO,CAAA,CAAE,IAAI,GAAG,IAAI,iBAAiB,CAAC,CAAC;IAE9E,KAAK,CAAC,iBAAiB,CAAC,GAAG;MAAE,GAAG,EAAE,WAAW;MAAE,SAAS,EAAE,UAAU,CAAC,QAAQ,CAAA;IAAE,CAAE;IACjF,SAAS,CAAC,KAAK,CAAC;EACjB;AACH,CAAC;AAXY,OAAA,CAAA,cAAc,GAAA,cAAA;AAa3B;;;;AAIG;AACI,MAAM,YAAY,GAAI,GAAW,IAAI;EAC1C,MAAM,KAAK,GAAG,QAAQ,CAAA,CAAE;EACxB,MAAM,aAAa,GAAG,GAAG,CAAC,WAAW,CAAA,CAAE;EACvC,MAAM,IAAI,GAAG,KAAK,CAAC,aAAa,CAAC;EAEjC,IAAI,IAAI,EAAE;IACR,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,IAAI,CAAA,CAAE,EAAE;MACzC,OAAO,IAAI,CAAC,GAAG;IAChB;EACF;EAED,OAAO,IAAI;AACb,CAAC;AAZY,OAAA,CAAA,YAAY,GAAA,YAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getCachedUrl = exports.storeCachedURI = void 0;\n// 24 hour TTL\nconst DEFAULT_CACHE_TTL = 60 * 60 * 24 * 1000;\nconst getCache = () => {\n    const cache = window.localStorage.getItem('davatar/cache');\n    if (!cache) {\n        window.localStorage.setItem('davatar/cache', '{}');\n        return {};\n    }\n    return JSON.parse(cache);\n};\nconst saveCache = (cache) => window.localStorage.setItem('davatar/cache', JSON.stringify(cache));\nconst storeCachedURI = (address, resolvedUrl, ttl) => {\n    const cache = getCache();\n    const normalizedAddress = address.toLowerCase();\n    const item = cache[normalizedAddress];\n    if (!item || new Date(item.expiresAt) > new Date()) {\n        const expireDate = new Date(new Date().getTime() + (ttl || DEFAULT_CACHE_TTL));\n        cache[normalizedAddress] = { url: resolvedUrl, expiresAt: expireDate.toString() };\n        saveCache(cache);\n    }\n};\nexports.storeCachedURI = storeCachedURI;\n/**\n * Get cached resolved url from local storage\n *\n * @param key - an ethereum address or an avatar URI\n */\nconst getCachedUrl = (key) => {\n    const cache = getCache();\n    const normalizedKey = key.toLowerCase();\n    const item = cache[normalizedKey];\n    if (item) {\n        if (new Date(item.expiresAt) > new Date()) {\n            return item.url;\n        }\n    }\n    return null;\n};\nexports.getCachedUrl = getCachedUrl;\n//# sourceMappingURL=cache.js.map"]},"metadata":{},"sourceType":"script"}