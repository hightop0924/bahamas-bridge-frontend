{"ast":null,"code":"var _jsxFileName = \"/home/hightop/bahamas_bridge/omnibridge-ui/packages/dapp/src/components/bridge/UnlockButton.jsx\",\n  _s = $RefreshSig$();\nimport { Flex, Image, Link, Spinner, Text, useToast } from '@chakra-ui/react';\nimport UnlockIcon from \"assets/unlock.svg\";\nimport { TxLink } from 'components/common/TxLink';\nimport { useBridgeContext } from 'contexts/BridgeContext';\nimport { useWeb3Context } from 'contexts/Web3Context';\nimport { useTokenDisabled } from 'hooks/useTokenDisabled';\nimport { isRevertedError } from 'lib/amb';\nimport { getNetworkName, handleWalletError } from 'lib/helpers';\nimport React, { useCallback } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const UnlockButton = ({\n  approval,\n  isValid\n}) => {\n  _s();\n  const {\n    providerChainId\n  } = useWeb3Context();\n  const {\n    fromAmount: amount,\n    fromBalance: balance,\n    fromToken: token,\n    toAmountLoading\n  } = useBridgeContext();\n  const {\n    allowed,\n    approve,\n    unlockLoading,\n    approvalTxHash\n  } = approval;\n  const isBridgingDisabled = useTokenDisabled(token);\n  const buttonDisabled = !token || allowed || toAmountLoading || isBridgingDisabled || !isValid;\n  const toast = useToast();\n  const showError = useCallback(msg => {\n    if (msg) {\n      toast({\n        title: 'Error',\n        description: msg,\n        status: 'error',\n        isClosable: 'true'\n      });\n    }\n  }, [toast]);\n  const valid = useCallback(() => {\n    if (!providerChainId) {\n      showError('Please connect wallet');\n      return false;\n    }\n    if (providerChainId !== (token === null || token === void 0 ? void 0 : token.chainId)) {\n      showError(`Please switch to ${getNetworkName(token === null || token === void 0 ? void 0 : token.chainId)}`);\n      return false;\n    }\n    if (amount.lte(0)) {\n      showError('Please specify amount');\n      return false;\n    }\n    if (balance.lt(amount)) {\n      showError('Not enough balance');\n      return false;\n    }\n    return true;\n  }, [providerChainId, token === null || token === void 0 ? void 0 : token.chainId, amount, balance, showError]);\n  const onClick = useCallback(() => {\n    if (!unlockLoading && !buttonDisabled && valid()) {\n      approve().catch(error => {\n        if (error && error.message) {\n          if (isRevertedError(error) || error.data && (error.data.includes('Bad instruction fe') || error.data.includes('Reverted'))) {\n            showError( /*#__PURE__*/_jsxDEV(Text, {\n              children: [\"There is problem with the token unlock. Try to revoke previous approval if any on\", ' ', /*#__PURE__*/_jsxDEV(Link, {\n                href: \"https://revoke.cash\",\n                textDecor: \"underline\",\n                isExternal: true,\n                children: \"https://revoke.cash/\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 72,\n                columnNumber: 17\n              }, this), ' ', \"and try again.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 15\n            }, this));\n          } else {\n            handleWalletError(error, showError);\n          }\n        } else {\n          showError('Impossible to perform the operation. Reload the application and try again.');\n        }\n      });\n    }\n  }, [unlockLoading, buttonDisabled, valid, showError, approve]);\n  return /*#__PURE__*/_jsxDEV(Flex, {\n    align: \"center\",\n    as: \"button\",\n    color: \"cyan.500\",\n    _hover: buttonDisabled ? undefined : {\n      color: 'cyan.600'\n    },\n    cursor: buttonDisabled ? 'not-allowed' : 'pointer',\n    transition: \"0.25s\",\n    position: \"relative\",\n    opacity: buttonDisabled ? 0.4 : 1,\n    onClick: onClick,\n    borderRadius: \"0.25rem\",\n    w: {\n      base: '10rem',\n      sm: '12rem',\n      lg: 'auto'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n      width: \"100%\",\n      viewBox: \"0 0 156 42\",\n      fill: \"none\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M139.086 39.72a4 4 0 01-3.612 2.28H20.526a4 4 0 01-3.612-2.28l-16.19-34C-.54 3.065 1.395 0 4.335 0h147.33c2.94 0 4.875 3.065 3.611 5.72l-16.19 34z\",\n        fill: \"currentColor\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Flex, {\n      position: \"absolute\",\n      w: \"100%\",\n      h: \"100%\",\n      justify: \"center\",\n      align: \"center\",\n      children: unlockLoading ? /*#__PURE__*/_jsxDEV(TxLink, {\n        chainId: providerChainId,\n        hash: approvalTxHash,\n        children: /*#__PURE__*/_jsxDEV(Spinner, {\n          color: \"white\",\n          size: \"sm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          color: \"white\",\n          fontWeight: \"bold\",\n          children: buttonDisabled ? 'Unlocked' : 'Unlock'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Image, {\n          src: UnlockIcon,\n          ml: 2\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n};\n_s(UnlockButton, \"GsheKa9nJA9eFOU3OlbvpG9HFiM=\", false, function () {\n  return [useWeb3Context, useBridgeContext, useTokenDisabled, useToast];\n});\n_c = UnlockButton;\nvar _c;\n$RefreshReg$(_c, \"UnlockButton\");","map":{"version":3,"names":["Flex","Image","Link","Spinner","Text","useToast","UnlockIcon","TxLink","useBridgeContext","useWeb3Context","useTokenDisabled","isRevertedError","getNetworkName","handleWalletError","React","useCallback","jsxDEV","_jsxDEV","Fragment","_Fragment","UnlockButton","approval","isValid","_s","providerChainId","fromAmount","amount","fromBalance","balance","fromToken","token","toAmountLoading","allowed","approve","unlockLoading","approvalTxHash","isBridgingDisabled","buttonDisabled","toast","showError","msg","title","description","status","isClosable","valid","chainId","lte","lt","onClick","catch","error","message","data","includes","children","href","textDecor","isExternal","fileName","_jsxFileName","lineNumber","columnNumber","align","as","color","_hover","undefined","cursor","transition","position","opacity","borderRadius","w","base","sm","lg","width","viewBox","fill","d","h","justify","hash","size","fontWeight","src","ml","_c","$RefreshReg$"],"sources":["/home/hightop/bahamas_bridge/omnibridge-ui/packages/dapp/src/components/bridge/UnlockButton.jsx"],"sourcesContent":["import { Flex, Image, Link, Spinner, Text, useToast } from '@chakra-ui/react';\nimport UnlockIcon from 'assets/unlock.svg';\nimport { TxLink } from 'components/common/TxLink';\nimport { useBridgeContext } from 'contexts/BridgeContext';\nimport { useWeb3Context } from 'contexts/Web3Context';\nimport { useTokenDisabled } from 'hooks/useTokenDisabled';\nimport { isRevertedError } from 'lib/amb';\nimport { getNetworkName, handleWalletError } from 'lib/helpers';\nimport React, { useCallback } from 'react';\n\nexport const UnlockButton = ({ approval, isValid }) => {\n  const { providerChainId } = useWeb3Context();\n  const {\n    fromAmount: amount,\n    fromBalance: balance,\n    fromToken: token,\n    toAmountLoading,\n  } = useBridgeContext();\n\n  const { allowed, approve, unlockLoading, approvalTxHash } = approval;\n  const isBridgingDisabled = useTokenDisabled(token);\n  const buttonDisabled =\n    !token || allowed || toAmountLoading || isBridgingDisabled || !isValid;\n  const toast = useToast();\n  const showError = useCallback(\n    msg => {\n      if (msg) {\n        toast({\n          title: 'Error',\n          description: msg,\n          status: 'error',\n          isClosable: 'true',\n        });\n      }\n    },\n    [toast],\n  );\n  const valid = useCallback(() => {\n    if (!providerChainId) {\n      showError('Please connect wallet');\n      return false;\n    }\n    if (providerChainId !== token?.chainId) {\n      showError(`Please switch to ${getNetworkName(token?.chainId)}`);\n      return false;\n    }\n    if (amount.lte(0)) {\n      showError('Please specify amount');\n      return false;\n    }\n    if (balance.lt(amount)) {\n      showError('Not enough balance');\n      return false;\n    }\n    return true;\n  }, [providerChainId, token?.chainId, amount, balance, showError]);\n\n  const onClick = useCallback(() => {\n    if (!unlockLoading && !buttonDisabled && valid()) {\n      approve().catch(error => {\n        if (error && error.message) {\n          if (\n            isRevertedError(error) ||\n            (error.data &&\n              (error.data.includes('Bad instruction fe') ||\n                error.data.includes('Reverted')))\n          ) {\n            showError(\n              <Text>\n                There is problem with the token unlock. Try to revoke previous\n                approval if any on{' '}\n                <Link\n                  href=\"https://revoke.cash\"\n                  textDecor=\"underline\"\n                  isExternal\n                >\n                  https://revoke.cash/\n                </Link>{' '}\n                and try again.\n              </Text>,\n            );\n          } else {\n            handleWalletError(error, showError);\n          }\n        } else {\n          showError(\n            'Impossible to perform the operation. Reload the application and try again.',\n          );\n        }\n      });\n    }\n  }, [unlockLoading, buttonDisabled, valid, showError, approve]);\n\n  return (\n    <Flex\n      align=\"center\"\n      as=\"button\"\n      color=\"cyan.500\"\n      _hover={\n        buttonDisabled\n          ? undefined\n          : {\n              color: 'cyan.600',\n            }\n      }\n      cursor={buttonDisabled ? 'not-allowed' : 'pointer'}\n      transition=\"0.25s\"\n      position=\"relative\"\n      opacity={buttonDisabled ? 0.4 : 1}\n      onClick={onClick}\n      borderRadius=\"0.25rem\"\n      w={{ base: '10rem', sm: '12rem', lg: 'auto' }}\n    >\n      <svg width=\"100%\" viewBox=\"0 0 156 42\" fill=\"none\">\n        <path\n          d=\"M139.086 39.72a4 4 0 01-3.612 2.28H20.526a4 4 0 01-3.612-2.28l-16.19-34C-.54 3.065 1.395 0 4.335 0h147.33c2.94 0 4.875 3.065 3.611 5.72l-16.19 34z\"\n          fill=\"currentColor\"\n        />\n      </svg>\n      <Flex\n        position=\"absolute\"\n        w=\"100%\"\n        h=\"100%\"\n        justify=\"center\"\n        align=\"center\"\n      >\n        {unlockLoading ? (\n          <TxLink chainId={providerChainId} hash={approvalTxHash}>\n            <Spinner color=\"white\" size=\"sm\" />\n          </TxLink>\n        ) : (\n          <>\n            <Text color=\"white\" fontWeight=\"bold\">\n              {buttonDisabled ? 'Unlocked' : 'Unlock'}\n            </Text>\n            <Image src={UnlockIcon} ml={2} />\n          </>\n        )}\n      </Flex>\n    </Flex>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}